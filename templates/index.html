<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
  crossorigin="anonymous"
/>

<!DOCTYPE html>
<html>
  <head>
    <title>SRA Metadata Query</title>
    <script
      defer="defer"
      src="static/files/mgnify-sourmash-component/dist/mgnify-sourmash-component.js"
    ></script>
  </head>
  <body>
    <h1>SRA Metadata Query</h1>
    <br />
    <h2>1) Upload your genome (fasta format)</h2>
    <div>
      <mgnify-sourmash-component id="sourmash" ksize="21" scaled="1000" />
    </div>
    <br />

    <h2>2) Once the genome is uploaded, submit metadata options</h2>

    <form id="myForm">
      <label>
        <input type="checkbox" name="organism" value="organism" />
        Organism </label
      ><br />
      <label>
        <input type="checkbox" name="option2" value="Option 2" /> Option 2 </label
      ><br />
      <label>
        <input type="checkbox" name="option3" value="Option 3" /> Option 3 </label
      ><br /><br />
      <input type="submit" value="Submit" />
    </form>

    <!--Needs a way to ensure genome is uploaded and signatures created before metadata is submitted-->
    <script>
      var signature;
      document.addEventListener("sketched", (evt) => {
        evt.preventDefault();
        signature = evt.detail.signature;
      });

      const form = document.getElementById("myForm");

      form.addEventListener("submit", (event) => {
        event.preventDefault();

        const data = {
          signatures: signature,
          metadata: {
            organism: form.elements.organism.checked,
            option2: form.elements.option2.checked,
            option3: form.elements.option3.checked,
          },
        };

        fetch("/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((response) => response.json())
          .then((data) => console.log(data))
          .catch((error) => console.error(error));
      });
    </script>
  </body>
</html>
