Building the mongoDB database for the webapp to access is dependent on bigquery. To build the db a bigquery service account is needed - it should be associated with a project 'sraproject', and a project needs to have a dataset called 'mastiffdata'.

Right now the query is setup to pull metadata for just 150,000 accessions to keep the db small while running locally for app troubleshooting. To remove this limit and pull metadata for all the accessions, remove 'LIMIT 150000' from L75 of bqtomongo.py.

## SET UP SRA METADATA ACCESS

Based on: - [Setting-up BigQuery](https://www.ncbi.nlm.nih.gov/sra/docs/sra-bigquery/)

1. Create project - 'sraproject'

2. Go to 'BigQuery' search tool

   1. In the 'Explorer panel' select '+ADD' to add data

   2. Select 'Star a project by name'

   3. Search: **nih-sra-datastore** and select

## CREATE SERVICE ACCOUNT KEY

1. Go to `navigation menu` - `IAM & Admin`: - `service accounts` `+ CREATE SERVICE ACCOUNT`

   - name: sraquery

   - ID: sraquery

     - NOTE - the name of the actual project id ### is autogenerated

   - Roles: BigQuery Job User; BigQuery Data Owner; BigQuery Read Sessions User

2. Once service account created, click the menu bar under 'actions' and choose 'Manage keys'

   1. select 'add key'

   2. 'create new key'

   3. key type: 'JSON'

   4. Download key to 'buildmongo' folder

   5. save as 'bqKey.json'

3. In big query console, under 'sraquery' create a dataset named 'mastiffdata'

## CREATE ACCESS IN BQTOMONGO.py:

1. Change project id on lines 22 and 24 to:'sraquery-####' and 'sraquery-####.mastiffdata.mastiff_id'
